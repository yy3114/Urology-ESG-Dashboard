<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ³Œå°¿ç§‘ ESG å½±éŸ¿åŠ›å„€è¡¨æ¿ (æ¦‚å¿µèªªæ˜)</title>
    <!-- è¼‰å…¥ Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* è¼‰å…¥ Inter å­—é«”ï¼Œæä¾›å°ˆæ¥­å¤–è§€ */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .score-bar { transition: width 0.5s ease-in-out, background-color 0.5s ease-in-out; }
        .card-bg-e { background-color: #e6f7e9; } /* Light Green */
        .card-bg-s { background-color: #e6f0fa; } /* Light Blue */
        .card-bg-g { background-color: #f7f3e6; } /* Light Yellow */
        
        /* ç¢ºä¿å‹•æ…‹é¡è‰²é¡åˆ¥è¢« Tailwind è­˜åˆ¥ */
        .bg-primary-green { background-color: #4CAF50; }
        .border-primary-green { border-color: #4CAF50; }
        .ring-primary-blue { --tw-ring-color: #2196F3; }
        .ring-primary-green { --tw-ring-color: #4CAF50; }
        .ring-primary-yellow { --tw-ring-color: #FFC107; }

        /* éš±è—/é¡¯ç¤ºçš„ç°¡æ˜“éæ¸¡æ•ˆæœ */
        .detail-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s ease-in-out, padding 0.4s ease-in-out;
        }
        .detail-content.show {
            max-height: 500px; /* è¶³å¤ å¤§çš„æ•¸å€¼ä»¥å®¹ç´å…§å®¹ */
            padding-top: 1rem;
            padding-bottom: 1rem;
        }

        /* Modal Styles */
        .modal {
            transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;
        }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary-green': '#4CAF50',
                        'primary-blue': '#2196F3',
                        'primary-yellow': '#FFC107',
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-gray-50 antialiased">

    <div id="app" class="min-h-screen p-4 sm:p-8 pb-32">
        
        <!-- Header -->
        <header class="text-center mb-6 max-w-3xl mx-auto">
            <h1 class="text-3xl sm:text-4xl font-extrabold text-gray-800 mb-2">æ³Œå°¿ç§‘ ESG å½±éŸ¿åŠ›å„€è¡¨æ¿</h1>
            <!-- æ ¹æ“šç”¨æˆ¶è¦æ±‚ï¼Œå°‡è¿½è¹¤æŒ‡æ¨™æ›è¡Œ -->
            <p class="text-gray-600 text-lg mb-4">é»æ“Šè¡Œå‹•é …ç›®ï¼Œå³æ™‚æŸ¥çœ‹è©³ç´°å¯¦æ–½ç­–ç•¥èˆ‡<br>è¿½è¹¤æŒ‡æ¨™ã€‚</p>
            
            <!-- Explanation Button -->
            <button onclick="showExplanationModal()" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-full shadow-sm text-white bg-primary-blue hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-blue transition duration-150">
                <svg class="w-5 h-5 mr-2 -ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                ä½•è¬‚ã€Œå½±éŸ¿åŠ›è¨ˆç®—å™¨ã€ï¼Ÿ
            </button>
        </header>

        <!-- ESG Pillars Container -->
        <div id="pillars-container" class="space-y-6 max-w-4xl mx-auto">
            <!-- Content will be injected by JavaScript -->
        </div>
        
    </div>

    <!-- Explanation Modal -->
    <div id="explanation-modal" class="modal fixed inset-0 bg-black bg-opacity-50 z-50 opacity-0 invisible flex items-center justify-center p-4" onclick="hideExplanationModal()">
        <div class="bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto" onclick="event.stopPropagation()">
            <div class="p-6 sm:p-8">
                <h2 class="text-2xl sm:text-3xl font-bold text-gray-800 mb-4 border-b pb-2 border-primary-green">ã€Œå½±éŸ¿åŠ›è¨ˆç®—å™¨ã€çš„æ„ç¾©èˆ‡ç”¨é€”</h2>
                
                <p class="text-lg text-gray-700 mb-6">
                    ã€Œå½±éŸ¿åŠ›è¨ˆç®—å™¨ã€çš„ä¸»è¦æ„ç¾©åœ¨æ–¼å°‡æŠ½è±¡çš„ **ESGï¼ˆç’°å¢ƒã€ç¤¾æœƒã€æ²»ç†ï¼‰** è¡Œå‹•**å…·é«”åŒ–å’Œé‡åŒ–**ã€‚
                    å®ƒæœ¬è³ªä¸Šæ˜¯ä¸€å€‹ **è¦åŠƒèˆ‡æ¨¡æ“¬å·¥å…· (Planning and Simulation Tool)**ï¼Œå…¶ç”¨é€”å¯ä»¥å¾å››å€‹ä¸»è¦å±¤é¢ä¾†ç†è§£ï¼š
                </p>

                <div class="space-y-6">
                    <!-- 1. ç­–ç•¥è¦åŠƒ -->
                    <div>
                        <h3 class="text-xl font-bold text-primary-green mb-2 flex items-center">
                            1. ç­–ç•¥è¦åŠƒèˆ‡è¡Œå‹•å„ªå…ˆç´šæ’åº
                        </h3>
                        <p class="text-gray-600 mb-2">
                            è¨ˆç®—å™¨çš„æ ¸å¿ƒç›®çš„ï¼Œæ˜¯å¹«åŠ©æ³Œå°¿ç§‘æ©Ÿæ§‹æˆ–è¨ºæ‰€çš„æ±ºç­–è€… **è¦–è¦ºåŒ–** ä¸åŒæ°¸çºŒè¡Œå‹•çš„**ç›¸å°é‡è¦æ€§**ã€‚
                        </p>
                        <ul class="list-disc ml-6 space-y-2 text-gray-600">
                            <li>
                                **é‡åŒ–æ±ºç­–ï¼š** æ¯å€‹è¡Œå‹•éƒ½æœ‰ä¸€å€‹ç‰¹å®šçš„**æ¬Šé‡åˆ†æ•¸**ï¼ˆä¾‹å¦‚ 12 åˆ†ã€9 åˆ†ï¼‰ã€‚é€™ä»£è¡¨è©²è¡Œå‹•åœ¨ ESG æ¡†æ¶ä¸‹ï¼Œå°æ–¼è¡Œæ¥­æˆ–ç¤¾æœƒå…·æœ‰çš„**æ½›åœ¨å½±éŸ¿åŠ›**ã€‚
                            </li>
                            <li>
                                **è³‡æºé…ç½®ï¼š** é€šéæ¨¡æ“¬ï¼Œæ‚¨å¯ä»¥æ¸…æ¥šçœ‹åˆ°æŠ•å…¥å“ªä¸€é …è¡Œå‹•ï¼ˆä¾‹å¦‚ï¼š**é è·é†«ç™‚** 12 åˆ† vs. **æ›´æ› LED ç‡ˆ** 10 åˆ†ï¼‰ï¼Œèƒ½åœ¨ Eã€Sã€G ä¸‰å€‹é¢å‘ä¸­ç²å¾—æœ€é«˜çš„ç¶œåˆå›å ±ï¼Œå¾è€Œå¹«åŠ©æ‚¨é€²è¡Œæ›´æœ‰æ•ˆçš„**é ç®—å’Œè³‡æºåˆ†é…**ã€‚
                            </li>
                        </ul>
                    </div>

                    <!-- 2. å…§éƒ¨åŸºæº–è¿½è¹¤ -->
                    <div>
                        <h3 class="text-xl font-bold text-primary-blue mb-2 flex items-center">
                            2. å…§éƒ¨åŸºæº–è¿½è¹¤ (Internal Benchmark)
                        </h3>
                        <p class="text-gray-600 mb-2">
                            å®ƒæ˜¯ä¸€ç¨® **ã€Œç›®æ¨™è¨­å®šèˆ‡é€²åº¦è¿½è¹¤ã€** çš„åŸºæº–ï¼š
                        </p>
                        <ul class="list-disc ml-6 space-y-2 text-gray-600">
                            <li>
                                **å…§éƒ¨è¿½è¹¤ï¼š** è©²è¨ˆç®—å™¨å°‡æ»¿åˆ†è¨­å®šç‚ºæ‰€æœ‰è¡Œå‹•æ¬Šé‡çš„ç¸½å’Œï¼ˆç¾åœ¨ç‚º **100 åˆ†**ï¼‰ã€‚æ‚¨æ¯å‹¾é¸ä¸€å€‹è¡Œå‹•ï¼Œå°±ä»£è¡¨è©²æ©Ÿæ§‹**å·²æ¡ç´æˆ–æ‰¿è«¾æ¡ç´**è©²é …å¯¦è¸ã€‚é€™è®“æ‚¨èƒ½å¤ è¨ˆç®—å‡ºä¸€å€‹æ¸…æ™°çš„ **ã€Œå¯¦ç¾åˆ†æ•¸ã€ (Actualized Score)**ã€‚
                            </li>
                            <li>
                                **è¨­å®šç›®æ¨™ï¼š** æ‚¨å¯ä»¥åˆ©ç”¨é€™å€‹åˆ†æ•¸ä½œç‚ºæœªä¾†å¹´åº¦çš„ **å…§éƒ¨ç›®æ¨™ (Goal Setting)**ã€‚æ¯”å¦‚ï¼Œä»Šå¹´çš„ç›®æ¨™æ˜¯é”åˆ° 60/100 åˆ†ï¼Œæ˜å¹´å¢åŠ åˆ° 80/100 åˆ†ã€‚
                            </li>
                        </ul>
                    </div>
                    
                    <!-- 3. åˆ†æ•¸è§£è®€èˆ‡åœ‹éš›æ¥è»Œ (New Section) -->
                    <div>
                        <h3 class="text-xl font-bold text-primary-yellow mb-2 flex items-center">
                            3. å½±éŸ¿åŠ›åˆ†æ•¸çš„æ·±åº¦è§£è®€èˆ‡åœ‹éš›æ¥è»Œ
                        </h3>
                        <p class="text-gray-600 font-semibold mt-4 mb-2">åˆ†æ•¸æ„ç¾©çš„åŠ å¼·è§£è®€ï¼š</p>
                        <ul class="list-disc ml-6 space-y-2 text-gray-600">
                            <li>
                                **é«˜åˆ†æ„ç¾© (ä¾‹å¦‚ > 80/100)ï¼š** è¡¨ç¤ºæ©Ÿæ§‹åœ¨ ESG å¯¦è¸ä¸Šå·²é”åˆ°**æˆç†Ÿ (Mature)** éšæ®µã€‚ä¸åƒ…éµå¾ªåŸºæœ¬æ³•è¦ï¼Œæ›´åœ¨**ä¾›æ‡‰éˆå¯©æ ¸**ã€**é è·é†«ç™‚å‰µæ–°**ã€**æ•¸æ“šä¿è­·**ç­‰é«˜æ¬Šé‡é ˜åŸŸåšå‡ºå“è¶Šè²¢ç»ã€‚é€™æ˜¯**å»ºç«‹è¡Œæ¥­é ˜å°åœ°ä½**çš„åŸºç¤ã€‚
                            </li>
                            <li>
                                **ä½åˆ†æ„ç¾© (ä¾‹å¦‚ < 50/100)ï¼š** è¡¨ç¤ºæ©Ÿæ§‹çš„ ESG ä»è™•æ–¼**åŸºç¤ (Foundational)** éšæ®µã€‚æ‡‰å„ªå…ˆé—œæ³¨ 12 åˆ†æˆ– 10 åˆ†çš„é«˜æ¬Šé‡è¡Œå‹•ï¼Œä»¥**æœ€å¤§åŒ–å½±éŸ¿åŠ›**å’Œ**é™ä½æ½›åœ¨çš„ç‡Ÿé‹é¢¨éšª** (å¦‚æ•¸æ“šæ´©éœ²ã€ç’°ä¿æ³•è¦ä¸ç¬¦)ã€‚
                            </li>
                        </ul>
                        <p class="text-gray-600 font-semibold mt-4 mb-2">èˆ‡åœ‹éš›æ¥è»Œï¼šé‡å¤§æ€§åŸå‰‡ (Materiality)ï¼š</p>
                        <ul class="list-disc ml-6 space-y-2 text-gray-600">
                            <li>
                                æœ¬è¨ˆç®—å™¨çš„æ¬Šé‡è¨­è¨ˆåƒè€ƒäº† **GRI (å…¨çƒå ±å‘Šå€¡è­°)** å’Œ **SASB (æ°¸çºŒæœƒè¨ˆæº–å‰‡å§”å“¡æœƒ)** ç­‰åœ‹éš›æ¨™æº–ä¸­çš„ **ã€Œé‡å¤§æ€§åŸå‰‡ã€**ã€‚
                            </li>
                            <li>
                                å°æ–¼é†«ç™‚æ©Ÿæ§‹è€Œè¨€ï¼Œ**ç—…æ‚£æ•¸æ“šéš±ç§ (G)**ã€**é†«ç™‚å»¢æ£„ç‰©ç®¡ç† (E)** å’Œ**é†«ç™‚æœå‹™å¯è¿‘æ€§ (S)** æ˜¯æœ€å…·å¯¦è³ªæ€§å½±éŸ¿çš„è­°é¡Œï¼Œå› æ­¤è¢«è³¦äºˆæ›´é«˜çš„æ¬Šé‡ã€‚
                            </li>
                            <li>
                                æ¡ç”¨åŠ æ¬Šæ¨¡å¼ï¼Œèƒ½ç¢ºä¿æ‚¨çš„è¡Œå‹•èˆ‡åœ‹éš›ä¸Šå°é†«ç™‚æ¥­ ESG è¡¨ç¾çš„é—œæ³¨é»ä¿æŒä¸€è‡´ã€‚
                            </li>
                        </ul>
                    </div>


                    <!-- 4. å“¡å·¥æ•™è‚²èˆ‡æ„è­˜æå‡ (Moved to 4th) -->
                    <div>
                        <h3 class="text-xl font-bold text-gray-800 mb-2 flex items-center">
                            4. å“¡å·¥æ•™è‚²èˆ‡æ„è­˜æå‡
                        </h3>
                        <ul class="list-disc ml-6 space-y-2 text-gray-600">
                            <li>
                                **åŒ–æŠ½è±¡ç‚ºå…·é«”ï¼š** ESG å¾€å¾€æ˜¯ä¸€å€‹å®å¤§è€ŒæŠ½è±¡çš„æ¦‚å¿µã€‚è¨ˆç®—å™¨å°‡å…¶è½‰åŒ–ç‚ºæ³Œå°¿ç§‘æ—¥å¸¸é‹ç‡Ÿä¸­çš„**å¯åŸ·è¡Œä»»å‹™**ï¼ˆå¦‚ï¼šå¦‚ä½•è™•ç†å»¢æ£„è—¥ç‰©ã€å¦‚ä½•ä¿è­·ç—…äººæ•¸æ“šï¼‰ã€‚
                            </li>
                            <li>
                                **å­¸ç¿’æ¡†æ¶ï¼š** é€šéé»æ“Šå’ŒæŸ¥çœ‹å±•é–‹çš„è©³ç´°å…§å®¹ï¼Œæ‰€æœ‰å“¡å·¥éƒ½èƒ½å¿«é€Ÿç†è§£ Eã€Sã€G ä¸‰å€‹é¢å‘å„è‡ªåŒ…å«çš„å¯¦éš›å…§å®¹ï¼Œä»¥åŠé€™äº›è¡Œå‹•ç‚ºä½•å°æ©Ÿæ§‹çš„æ°¸çºŒç™¼å±•è‡³é—œé‡è¦ã€‚
                            </li>
                        </ul>
                    </div>
                    
                    <p class="mt-6 pt-4 border-t text-sm italic text-gray-500 text-right">
                        ç¸½çµä¾†èªªï¼Œé€™å€‹å·¥å…·æ˜¯å¹«åŠ©æ‚¨**è¦åŠƒ**å’Œ**æºé€š** ESG ç­–ç•¥çš„èµ·é»ï¼Œæä¾›ä¸€å€‹å°‡è¡Œå‹•**æ•¸å€¼åŒ–**çš„æ¨¡æ“¬ç’°å¢ƒã€‚
                    </p>
                </div>
                
                <div class="mt-6 text-center">
                    <button onclick="hideExplanationModal()" class="px-6 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition">
                        é—œé–‰
                    </button>
                </div>
            </div>
        </div>
    </div>


    <!-- Overall Score Footer (Fixed for Mobile Visibility) -->
    <div id="overall-score-footer" class="fixed bottom-0 left-0 right-0 p-4 bg-white shadow-[0_-5px_15px_rgba(0,0,0,0.1)] z-20">
        <div class="max-w-4xl mx-auto flex flex-col sm:flex-row justify-between items-center space-y-2 sm:space-y-0">
            <div class="text-lg font-bold text-gray-700">ç¸½é«” ESG å½±éŸ¿åŠ›åˆ†æ•¸:</div>
            <div class="flex items-center space-x-4 w-full sm:w-auto">
                <div class="text-3xl font-extrabold" id="overall-score-display">0 / 100</div>
                <div class="w-full sm:w-48 h-3 bg-gray-200 rounded-full overflow-hidden">
                    <div id="overall-score-bar" class="score-bar h-full rounded-full" style="width: 0%; background-color: #ccc;"></div>
                </div>
            </div>
        </div>
    </div>


    <script>
        // è¨­å®š Firebase ç›¸é—œè®Šæ•¸ï¼ˆæ­¤è™•åƒ…ç‚ºè™›æ“¬ï¼Œç„¡éœ€å¯¦éš›åˆå§‹åŒ–ï¼‰
        const DUMMY_API_KEY = "";

        // *** æ¬Šé‡å·²èª¿æ•´ï¼Œç¢ºä¿ç¸½åˆ†ç‚º 100 åˆ† ***
        const pillarsData = [
            {
                id: 'E',
                name: 'ç’°å¢ƒ (Environmental)',
                color: 'primary-green',
                icon: 'ğŸŒ',
                description: 'é—œæ³¨é†«ç™‚å»¢æ£„ç‰©ç®¡ç†ã€èƒ½æºæ•ˆç‡èˆ‡è³‡æºç¯€ç´„ã€‚',
                actions: [
                    { 
                        name: 'ä½¿ç”¨å¯é‡è¤‡æ»…èŒçš„å™¨æ¢°ä»£æ›¿ä¸€æ¬¡æ€§ç”¨å“', 
                        weight: 12, checked: false, // åŸ 10 + 2
                        detail: 'æ¡ç”¨å¯é«˜å£“æ»…èŒæˆ–é‡è¤‡ä½¿ç”¨çš„æ‰‹è¡“å™¨æ¢°ï¼Œå¯ä»¥å¤§å¹…æ¸›å°‘ä¸€æ¬¡æ€§å¡‘è† å’ŒåŒ–å­¸å»¢æ£„ç‰©ã€‚é€™éœ€è¦åˆæœŸè¼ƒé«˜æŠ•è³‡ï¼Œä½†èƒ½é™ä½é•·æœŸæ¡è³¼æˆæœ¬ï¼Œä¸¦æ¸›è¼•ç„šåŒ–çˆçš„è² æ“”ã€‚',
                        example_metric: 'å¹´å¹³å‡ä¸€æ¬¡æ€§å™¨æ¢°ç”¨é‡ï¼ˆä»¶/æ‰‹è¡“ï¼‰',
                    },
                    { 
                        name: 'å°‡ç…§æ˜ç³»çµ±å…¨é¢æ›´æ›ç‚ºç¯€èƒ½LEDç‡ˆ', 
                        weight: 10, checked: false, // åŸ 8 + 2
                        detail: 'LED ç…§æ˜æ¯”å‚³çµ±ç‡ˆå…·ç¯€çœ 75% ä»¥ä¸Šçš„èƒ½æºï¼Œä¸¦æœ‰æ›´é•·çš„ä½¿ç”¨å£½å‘½ï¼Œæ¸›å°‘æ›´æ›å’Œå»¢æ£„ã€‚å®‰è£æ™ºèƒ½æ„Ÿæ‡‰å™¨å¯åœ¨ç„¡äººå€åŸŸè‡ªå‹•é—œé–‰ï¼Œé€²ä¸€æ­¥å„ªåŒ–é›»åŠ›ä½¿ç”¨ã€‚',
                        example_metric: 'å¹´åº¦ç¸½ç”¨é›»é‡ (kWh)',
                    },
                    { 
                        name: 'å¯¦æ–½ç„¡ç´™åŒ–ç—…æ­·èˆ‡é›»å­åŒ–è™•æ–¹ç±¤', 
                        weight: 7, checked: false, 
                        detail: 'æ¡ç”¨é›»å­ç—…æ­· (EMR) å’Œç—…äººå…¥å£ç¶²ç«™é€²è¡Œé ç´„ã€è™•æ–¹å’Œå ±å‘Šå‚³è¼¸ï¼Œä¸åƒ…ç¯€çœç´™å¼µå’Œç¢³ç²‰ï¼Œé‚„èƒ½æé«˜æ•¸æ“šæª¢ç´¢æ•ˆç‡å’Œå®‰å…¨æ€§ã€‚',
                        example_metric: 'å¹´åº¦ç´™å¼µæ¶ˆè€—é‡ï¼ˆä»¤ï¼‰',
                    },
                    { 
                        name: 'å»ºç«‹è—¥ç‰©å’ŒåŒ–å­¸å»¢æ£„ç‰©çš„å°ˆé–€å›æ”¶è™•ç†æµç¨‹', 
                        weight: 5, checked: false, 
                        detail: 'å»ºç«‹æ¸…æ™°çš„åˆ†æµå’Œå›æ”¶æŒ‡å—ï¼Œç‰¹åˆ¥æ˜¯é‡å°åŒ–ç™‚è—¥ç‰©ã€æ”¾å°„æ€§å»¢æ£„ç‰©å’Œé›»å­å»¢æ£„ç‰©ã€‚èˆ‡å°ˆæ¥­çš„ç’°ä¿è™•ç†å» å•†åˆä½œï¼Œç¢ºä¿å»¢æ£„ç‰©ä¸æœƒæ±¡æŸ“æ°´é«”æˆ–åœŸå£¤ã€‚',
                        example_metric: 'é†«ç™‚å»¢æ£„ç‰©å›æ”¶ç‡ (%)',
                    },
                ]
            }, // E Total: 34
            {
                id: 'S',
                name: 'ç¤¾æœƒ (Social)',
                color: 'primary-blue',
                icon: 'ğŸ¤',
                description: 'é—œæ³¨ç—…äººç…§è­·å“è³ªã€å“¡å·¥ç¦ç¥‰èˆ‡ç¤¾å€å¥åº·å…¬å¹³æ€§ã€‚',
                actions: [
                    { 
                        name: 'æä¾›é è·é†«ç™‚/è¦–è¨Šè«®è©¢æœå‹™ï¼Œæ“´å¤§åé åœ°å€å¯è¿‘æ€§', 
                        weight: 12, checked: false, // åŸ 10 + 2
                        detail: 'é è·è«®è©¢å’Œè¿½è¹¤æœå‹™ç‰¹åˆ¥é©åˆæ…¢æ€§æ³Œå°¿ç³»çµ±ç–¾ç—…æ‚£è€…æˆ–å±…ä½åœ¨åé åœ°å€çš„ç—…äººã€‚é€™èƒ½æ¸›å°‘ç—…äººå¾€è¿”é†«é™¢çš„äº¤é€šæ™‚é–“å’Œç¢³è¶³è·¡ï¼Œä¸¦æé«˜é†«ç™‚æœå‹™çš„ä¾¿åˆ©æ€§ã€‚',
                        example_metric: 'é è·é†«ç™‚æœå‹™è¦†è“‹ç‡ (%)',
                    },
                    { 
                        name: 'å®šæœŸèˆ‰è¾¦å‰åˆ—è…ºç™Œæˆ–æ³Œå°¿é“æ„ŸæŸ“å…è²»ç¤¾å€ç¯©æª¢æ´»å‹•', 
                        weight: 9, checked: false, // åŸ 8 + 1
                        detail: 'é€éå…è²»ç¯©æª¢æ´»å‹•ï¼ˆå¦‚ PSA æª¢æ¸¬æˆ–å°¿æ¶²åˆ†æï¼‰ï¼Œå¯ä»¥æ—©æœŸç™¼ç¾å‰åˆ—è…ºç™Œæˆ–æ³Œå°¿é“æ„ŸæŸ“ç­‰ç–¾ç—…ï¼Œé¡¯è‘—æé«˜æ²»ç™‚æˆåŠŸç‡ï¼Œä¸¦æ¸›å°‘å¾ŒæœŸé«˜æˆæœ¬çš„æ²»ç™‚éœ€æ±‚ã€‚',
                        example_metric: 'ç¤¾å€ç¯©æª¢åƒèˆ‡äººæ•¸',
                    },
                    { 
                        name: 'å»ºç«‹å“¡å·¥å¿ƒç†å¥åº·æ”¯æŒè¨ˆç•«ï¼Œæ‡‰å°é†«ç™‚å£“åŠ›', 
                        weight: 7, checked: false, 
                        detail: 'é†«ç™‚äººå“¡é¢è‡¨é«˜å¼·åº¦çš„å·¥ä½œå£“åŠ›å’Œç‡ƒç›¡é¢¨éšªã€‚æä¾›å¿ƒç†è«®è©¢ã€å½ˆæ€§æ’ç­å’Œå°ˆæ¥­ç™¼å±•æ©Ÿæœƒï¼Œèƒ½æé«˜å“¡å·¥ç•™ä»»ç‡å’Œå·¥ä½œæ»¿æ„åº¦ï¼Œé€²è€Œç©©å®šé†«ç™‚æœå‹™å“è³ªã€‚',
                        example_metric: 'å“¡å·¥ç•™ä»»ç‡ (%)',
                    },
                    { 
                        name: 'ç¢ºä¿é†«ç™‚åœ˜éšŠå…·å‚™å¤šå…ƒèƒŒæ™¯ä¸¦æä¾›èªè¨€ç¿»è­¯æœå‹™', 
                        weight: 5, checked: false, 
                        detail: 'ç¢ºä¿æ‰€æœ‰æ‚£è€…ï¼Œç„¡è«–å…¶ç¨®æ—ã€ç¶“æ¿ŸèƒŒæ™¯æˆ–èªè¨€èƒ½åŠ›ï¼Œéƒ½èƒ½ç²å¾—é«˜å“è³ªç…§è­·ã€‚æä¾›æ–‡åŒ–é©æ‡‰æ€§åŸ¹è¨“å’Œå°ˆæ¥­ç¿»è­¯æœå‹™ï¼Œæ˜¯å¯¦ç¾é†«ç™‚å…¬å¹³çš„é—œéµã€‚',
                        example_metric: 'èªè¨€æœå‹™ä½¿ç”¨ç‡ (%)',
                    },
                ]
            }, // S Total: 33
            {
                id: 'G',
                name: 'æ²»ç† (Governance)',
                color: 'primary-yellow',
                icon: 'âš–ï¸',
                description: 'é—œæ³¨ç‡Ÿé‹é€æ˜åº¦ã€æ•¸æ“šå®‰å…¨èˆ‡é“å¾·æ¡è³¼ã€‚',
                actions: [
                    { 
                        name: 'å°ä¾›æ‡‰éˆé€²è¡Œé“å¾·å¯©æŸ¥ï¼ˆä¾‹å¦‚ï¼šç„¡ç«¥å·¥ã€ç’°ä¿èªè­‰å™¨æ¢°ï¼‰', 
                        weight: 12, checked: false, // åŸ 10 + 2
                        detail: 'å¯©æŸ¥é†«ç™‚è€—æä¾›æ‡‰å•†çš„ç¤¾æœƒå’Œç’°å¢ƒæ¨™æº–ï¼Œç¢ºä¿å…¶ç”¢å“ä¾†è‡ªåˆè¦ã€è² è²¬ä»»çš„ä¾†æºã€‚é€™é™ä½äº†æ¡è³¼é¢¨éšªï¼Œä¸¦æ”¯æŒæ›´å»£æ³›çš„å…¨çƒæ°¸çºŒç™¼å±•ç›®æ¨™ã€‚',
                        example_metric: 'ä¾›æ‡‰éˆä¸­é€šé ESG å¯©æ ¸çš„æ¯”ä¾‹ (%)',
                    },
                    { 
                        name: 'å¯¦æ–½é«˜æ¨™æº–çš„ç—…äººæ•¸æ“šåŠ å¯†å’Œéš±ç§ä¿è­·å”å®š (GDPR/HIPAA)', 
                        weight: 9, checked: false, // åŸ 8 + 1
                        detail: 'æŠ•è³‡æ–¼å…ˆé€²çš„ç¶²çµ¡å®‰å…¨ç³»çµ±å’Œå“¡å·¥åŸ¹è¨“ï¼Œä»¥ä¿è­·æ•æ„Ÿçš„ç—…äººé†«ç™‚è¨˜éŒ„ (EHR)ã€‚éµå®ˆåœ‹éš›éš±ç§æ³•è¦ä¸åƒ…æ˜¯æ³•å¾‹è¦æ±‚ï¼Œä¹Ÿæ˜¯å»ºç«‹ç—…äººä¿¡ä»»çš„åŸºçŸ³ã€‚',
                        example_metric: 'å¹´åº¦æ•¸æ“šæ´©éœ²äº‹ä»¶æ•¸é‡ï¼ˆç†æƒ³å€¼ç‚º 0ï¼‰',
                    },
                    { 
                        name: 'å»ºç«‹å…¬é–‹é€æ˜çš„è‡¨åºŠçµæœå ±å‘Šæ©Ÿåˆ¶', 
                        weight: 7, checked: false, 
                        detail: 'å®šæœŸå‘å…¬çœ¾å’Œåˆ©ç›Šç›¸é—œè€…å ±å‘Šè‡¨åºŠçµæœï¼ˆå¦‚æ‰‹è¡“æˆåŠŸç‡ã€æ„ŸæŸ“ç‡ï¼‰å’Œ ESG è¡¨ç¾ã€‚é«˜é€æ˜åº¦èƒ½å¢å¼·æ©Ÿæ§‹ä¿¡è­½ï¼Œä¸¦ä¿ƒé€²æŒçºŒçš„å“è³ªæ”¹é€²ã€‚',
                        example_metric: 'é—œéµç¸¾æ•ˆæŒ‡æ¨™ (KPI) å…¬é–‹å ±å‘Šé »ç‡ï¼ˆå­£åº¦/å¹´åº¦ï¼‰',
                    },
                    { 
                        name: 'æˆç«‹ç”±å¤šéƒ¨é–€çµ„æˆçš„ESGå°ˆè²¬å§”å“¡æœƒ', 
                        weight: 5, checked: false, 
                        detail: 'è¨­ç«‹ä¸€å€‹ç”±ç®¡ç†å±¤ã€è‡¨åºŠé†«ç”Ÿå’Œè¡Œæ”¿äººå“¡çµ„æˆçš„æ­£å¼å§”å“¡æœƒï¼Œè² è²¬åˆ¶å®šã€ç›£ç£å’Œæ¨å‹• ESG ç­–ç•¥ã€‚é€™ç¢ºä¿äº†æ°¸çºŒç™¼å±•ç›®æ¨™èˆ‡æ ¸å¿ƒæ¥­å‹™æ±ºç­–ä¿æŒä¸€è‡´ã€‚',
                        example_metric: 'ESG å§”å“¡æœƒæœƒè­°é »ç‡å’Œæ±ºç­–åŸ·è¡Œç‡ (%)',
                    },
                ]
            } // G Total: 33
        ];

        // ç¸½æ»¿åˆ†æ˜¯æ‰€æœ‰æ¬Šé‡çš„ç¸½å’Œ
        // MAX_SCORE ç¾åœ¨æœƒæ­£ç¢ºè¨ˆç®—ç‚º 34 + 33 + 33 = 100
        const MAX_SCORE = pillarsData.reduce((total, pillar) => 
            total + pillar.actions.reduce((sum, action) => sum + action.weight, 0), 0);
        
        // --- Core Logic Functions ---

        /**
         * æ ¹æ“šç™¾åˆ†æ¯”è¿”å›é€²åº¦æ¢é¡è‰²ã€‚
         * @param {number} percentage - ç•¶å‰åˆ†æ•¸ç™¾åˆ†æ¯”
         */
        function getScoreColor(percentage) {
            if (percentage < 33) return '#F44336'; // Red
            if (percentage < 66) return '#FF9800'; // Orange
            return '#4CAF50'; // Green
        }

        /**
         * è¨ˆç®—ä¸¦æ›´æ–°ç¸½é«” ESG åˆ†æ•¸å’Œé€²åº¦æ¢ã€‚
         */
        function updateOverallScore() {
            let currentScore = 0;
            pillarsData.forEach(pillar => {
                pillar.actions.forEach(action => {
                    if (action.checked) {
                        currentScore += action.weight;
                    }
                });
            });

            const percentage = (currentScore / MAX_SCORE) * 100;

            const scoreDisplay = document.getElementById('overall-score-display');
            const scoreBar = document.getElementById('overall-score-bar');

            scoreDisplay.textContent = `${currentScore} / ${MAX_SCORE}`;
            scoreBar.style.width = `${percentage}%`;
            scoreBar.style.backgroundColor = getScoreColor(percentage);
        }

        /**
         * è¨ˆç®—ä¸¦æ›´æ–°ç‰¹å®š ESG æŸ±å­çš„åˆ†æ•¸å’Œé€²åº¦æ¢ã€‚
         * @param {string} pillarId - æŸ±å­ ID (E, S, G)
         */
        function updatePillarScore(pillarId) {
            const pillar = pillarsData.find(p => p.id === pillarId);
            if (!pillar) return;

            const totalPillarScore = pillar.actions.reduce((sum, a) => sum + a.weight, 0);
            const currentPillarScore = pillar.actions.filter(a => a.checked).reduce((sum, a) => sum + a.weight, 0);
            const pillarPercentage = (currentPillarScore / totalPillarScore) * 100;
            
            const scoreDisplay = document.getElementById(`pillar-score-${pillar.id}`);
            const scoreBar = document.getElementById(`pillar-bar-${pillar.id}`);

            // ç¢ºä¿å…ƒç´ å­˜åœ¨å¾Œå†æ›´æ–°
            if (scoreDisplay) scoreDisplay.innerHTML = `${currentPillarScore}</span><span class="text-lg text-gray-500"> / ${totalPillarScore}`;
            if (scoreBar) scoreBar.style.width = `${pillarPercentage}%`;
        }

        /**
         * è™•ç†é»æ“Šäº‹ä»¶ä¾†åˆ‡æ›è¡Œå‹•çš„é¸ä¸­ç‹€æ…‹ä¸¦åˆ‡æ›è©³ç´°å…§å®¹çš„é¡¯ç¤ºã€‚
         * @param {string} pillarId - æŸ±å­ ID (E, S, G)
         * @param {number} actionIndex - è¡Œå‹•åœ¨é™£åˆ—ä¸­çš„ç´¢å¼•
         */
        function toggleAction(pillarId, actionIndex) {
            const pillar = pillarsData.find(p => p.id === pillarId);
            if (pillar) {
                const action = pillar.actions[actionIndex];
                
                // 1. æ ¸å¿ƒé‚è¼¯ï¼šåˆ‡æ›ç‹€æ…‹
                action.checked = !action.checked;
                
                // 2. æ›´æ–°åˆ†æ•¸
                updateOverallScore();
                updatePillarScore(pillarId); // æ›´æ–°å–®å€‹æŸ±å­åˆ†æ•¸

                // 3. è¦–è¦ºæ›´æ–°ï¼šæ‰¾åˆ°ç›¸é—œDOMå…ƒç´ ä¸¦åˆ‡æ›ç‹€æ…‹
                const actionKey = `${pillarId}-${actionIndex}`;
                const container = document.querySelector(`.action-container[data-action-key="${actionKey}"]`);
                const detailPanel = document.getElementById(`detail-${pillarId}-${actionIndex}`);
                const indicator = container.querySelector('.action-item-indicator');
                const arrow = container.querySelector('.detail-arrow');
                
                const pillarColorClass = `ring-${pillar.color}`; 
                const iconSvg = '<svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path></svg>';
                const greenBgClass = 'bg-primary-green';
                const greenBorderClass = 'border-primary-green';

                if (container && detailPanel && indicator && arrow) {
                    if (action.checked) {
                        // ç‹€æ…‹ï¼šé¸ä¸­ä¸¦é¡¯ç¤ºç´°ç¯€
                        container.classList.add('ring-2', 'ring-inset', pillarColorClass);
                        indicator.classList.remove('bg-white', 'border-gray-300');
                        indicator.classList.add(greenBgClass, greenBorderClass);
                        indicator.innerHTML = iconSvg;

                        detailPanel.classList.add('show');
                        arrow.classList.add('rotate-90');
                        arrow.classList.remove('rotate-0');
                        
                    } else {
                        // ç‹€æ…‹ï¼šæœªé¸ä¸­ä¸¦éš±è—ç´°ç¯€
                        container.classList.remove('ring-2', 'ring-inset', pillarColorClass);
                        indicator.classList.remove(greenBgClass, greenBorderClass);
                        indicator.classList.add('bg-white', 'border-gray-300');
                        indicator.innerHTML = '';
                        
                        detailPanel.classList.remove('show');
                        arrow.classList.remove('rotate-90');
                        arrow.classList.add('rotate-0');
                    }
                }
            }
        }
        
        /**
         * é¡¯ç¤ºè§£é‡‹æ¨¡æ…‹æ¡†ã€‚
         */
        function showExplanationModal() {
            const modal = document.getElementById('explanation-modal');
            modal.classList.remove('invisible', 'opacity-0');
            modal.classList.add('visible', 'opacity-100');
        }

        /**
         * éš±è—è§£é‡‹æ¨¡æ…‹æ¡†ã€‚
         */
        function hideExplanationModal() {
            const modal = document.getElementById('explanation-modal');
            modal.classList.remove('visible', 'opacity-100');
            modal.classList.add('invisible', 'opacity-0');
        }


        // --- Rendering Functions ---

        /**
         * æ¸²æŸ“å–®å€‹ ESG æŸ±å­å¡ç‰‡ã€‚
         * @param {object} pillar - æŸ±å­æ•¸æ“š
         */
        function renderPillarCard(pillar) {
            const pillarElement = document.createElement('div');
            pillarElement.className = `p-6 rounded-2xl shadow-lg ring-1 ring-opacity-50 ring-${pillar.color} card-bg-${pillar.id.toLowerCase()} backdrop-blur-sm`;
            
            const totalPillarScore = pillar.actions.reduce((sum, a) => sum + a.weight, 0);
            const currentPillarScore = pillar.actions.filter(a => a.checked).reduce((sum, a) => sum + a.weight, 0);
            const pillarPercentage = (currentPillarScore / totalPillarScore) * 100;

            const pillarColorHex = tailwind.config.theme.extend.colors[pillar.color];

            let actionsHtml = pillar.actions.map((action, index) => {
                const isChecked = action.checked;
                const detailId = `detail-${pillar.id}-${index}`;
                const actionKey = `${pillar.id}-${index}`;

                // ç§»é™¤ LaTeX ç¬¦è™Ÿï¼Œæº–å‚™é¡¯ç¤º
                const cleanDetail = action.detail.replace(/\\text{/g, '').replace(/}/g, '').replace(/\$/g, '');
                const cleanMetric = action.example_metric.replace(/\\text{/g, '').replace(/}/g, '').replace(/\$/g, '');

                return `
                    <div data-action-key="${actionKey}" class="action-container rounded-xl overflow-hidden shadow-sm transition duration-200 ${isChecked ? `ring-2 ring-inset ring-primary-blue bg-white/90` : 'bg-white hover:shadow-md'}">
                        <div 
                            class="flex items-center p-3 cursor-pointer"
                            onclick="toggleAction('${pillar.id}', ${index})"
                        >
                            <!-- Checkbox/Indicator -->
                            <div class="action-item-indicator w-5 h-5 border-2 rounded-md flex items-center justify-center transition duration-150 
                                ${isChecked ? 'bg-primary-green border-primary-green' : 'bg-white border-gray-300'}">
                                ${isChecked ? '<svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path></svg>' : ''}
                            </div>
                            
                            <span class="ml-3 text-base text-gray-800 flex-1">
                                ${action.name} 
                                <span class="text-sm font-semibold text-gray-500 ml-2">(${action.weight}åˆ†)</span>
                            </span>
                            
                            <!-- Detail Indicator Arrow -->
                            <svg class="detail-arrow w-5 h-5 text-gray-400 transform transition duration-200 ${isChecked ? 'rotate-90' : 'rotate-0'}" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
                        </div>

                        <!-- Detail Content - Local Display (KPI moved to top) -->
                        <div id="${detailId}" class="detail-content bg-gray-50 border-t border-gray-200 ${isChecked ? 'show' : ''}">
                            <div class="space-y-3 p-4">
                                
                                <!-- ğŸ“Š è¿½è¹¤æŒ‡æ¨™ (KPI) - ç§»è‡³é ‚éƒ¨ -->
                                <h4 class="text-sm font-bold text-gray-700">ğŸ“Š è¿½è¹¤æŒ‡æ¨™ (KPI)ï¼š</h4>
                                <p class="text-${pillar.color} font-mono text-xs p-2 bg-gray-100 rounded-lg">${cleanMetric}</p>

                                <!-- å¯¦æ–½ç­–ç•¥èˆ‡æ•ˆç›Š - æ”¾åœ¨ä¸‹æ–¹ï¼Œä¸¦åŠ ä¸Šä¸Šé‚Šè·ä»¥å€éš” -->
                                <h4 class="text-sm font-bold text-gray-700 mt-2">å¯¦æ–½ç­–ç•¥èˆ‡æ•ˆç›Šï¼š</h4>
                                <p class="text-gray-600 text-sm">${cleanDetail}</p>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');

            pillarElement.innerHTML = `
                <div class="flex items-start justify-between mb-4">
                    <div>
                        <h2 class="text-2xl font-bold text-gray-800 flex items-center mb-1">
                            ${pillar.icon} <span class="ml-3">${pillar.name}</span>
                        </h2>
                        <p class="text-gray-600 text-sm">${pillar.description}</p>
                    </div>
                    <div class="text-right">
                         <span class="text-3xl font-extrabold text-${pillar.color}" id="pillar-score-${pillar.id}">${currentPillarScore}</span><span class="text-lg text-gray-500"> / ${totalPillarScore}</span>
                    </div>
                </div>

                <div class="w-full h-2 mb-6 bg-gray-200 rounded-full overflow-hidden">
                    <div id="pillar-bar-${pillar.id}" class="score-bar h-full rounded-full" style="width: ${pillarPercentage}%; background-color: ${pillarColorHex};"></div>
                </div>

                <div class="space-y-3">
                    <h3 class="text-lg font-semibold text-gray-700 border-b border-gray-300 pb-1">å…·é«”å¯¦è¸è¡Œå‹•ï¼š</h3>
                    ${actionsHtml}
                </div>
            `;
            return pillarElement;
        }

        /**
         * æ¸²æŸ“æ‰€æœ‰ ESG æŸ±å­åˆ°å®¹å™¨ä¸­ã€‚
         */
        function renderPillars() {
            const container = document.getElementById('pillars-container');
            container.innerHTML = ''; // æ¸…ç©ºèˆŠå…§å®¹
            pillarsData.forEach(pillar => {
                container.appendChild(renderPillarCard(pillar));
            });
        }

        // --- Initialization ---
        window.onload = function() {
            // å°‡å‡½æ•¸æš´éœ²çµ¦ HTML å…ƒç´ çš„ onclick
            window.toggleAction = toggleAction; 
            window.showExplanationModal = showExplanationModal;
            window.hideExplanationModal = hideExplanationModal;
            
            // åˆå§‹æ¸²æŸ“
            renderPillars();
            updateOverallScore();

            console.log("æ³Œå°¿ç§‘ ESG å½±éŸ¿åŠ›å„€è¡¨æ¿å·²è¼‰å…¥ã€‚é»æ“Šè¡Œå‹•é …ç›®ä»¥åˆ‡æ›ç‹€æ…‹ä¸¦æŸ¥çœ‹ç´°ç¯€ã€‚");
        };

    </script>
</body>
</html>

